// Enhanced render engine styles with better specificity and coverage
.reactjs-tiptap-render-engine.reactjs-tiptap-render-engine {
  // Loading state styles
  &-loading {
    @apply richtext-flex richtext-items-center richtext-justify-center;
    @apply richtext-bg-background richtext-border richtext-border-border richtext-rounded-md;
    @apply richtext-text-muted-foreground;
  }

  .ProseMirror.ProseMirror.ProseMirror {
    @apply richtext-caret-transparent richtext-outline-0 richtext-z-0;
    min-height: auto;
    padding: 16px 24px;
    cursor: default;
    user-select: text;

    // Enhanced responsive padding
    @apply richtext-px-4 richtext-py-4 sm:richtext-px-6 sm:richtext-py-6 lg:richtext-px-8 lg:richtext-py-8;

    // Remove all interactive hover effects for read-only mode
    * {
      pointer-events: none !important;
      cursor: default !important;
    }

    // Allow text selection
    *:not(button):not(input):not(textarea):not(select) {
      user-select: text !important;
    }

    // Remove hover effects for read-only
    [data-type='horizontalRule']:hover,
    .image-view__body:hover,
    .tableWrapper:hover,
    *:hover {
      background: transparent !important;
      outline: none !important;
      box-shadow: none !important;
    }

    // Hide empty state placeholders
    .is-empty::before,
    .is-editor-empty:first-child::before,
    p.is-editor-empty:first-child::before {
      display: none !important;
    }

    // Hide all interactive elements
    .ProseMirror-gapcursor,
    .ProseMirror-dropcursor,
    .tableWrapper .grip-column,
    .tableWrapper .grip-row,
    .tableWrapper .grip-table {
      display: none !important;
    }

    // Table wrapper styles - crucial for proper table rendering
    .tableWrapper {
      margin: 1em 0;
      @apply richtext-overflow-x-auto;

      table {
        overflow: hidden;
        display: table;
        width: 100%;

        // Ensure table cells have proper borders and padding
        td, th {
          @apply richtext-border richtext-border-black/10 richtext-min-w-[1em] richtext-p-2;
          @apply dark:richtext-border-white/20;
        }
      }
    }

    // Enhanced image view styles for perfect rendering
    .image-view {
      display: inline-block;
      float: none;
      max-width: 100%;
      line-height: 0;
      vertical-align: baseline;
      user-select: none;

      // Ensure proper spacing and layout
      margin: 0.5em 0;

      &__body {
        position: relative;
        display: inline-block;
        max-width: 100%;
        clear: both;
        outline: none !important;
        transition: none !important; // Remove transitions in render mode

        // Hide all interactive elements
        &__button-wrap,
        &__toolbar,
        .image-resizer,
        .image-upload-progress {
          display: none !important;
        }

        &:hover,
        &:focus,
        &.image-view__body--focused,
        &.image-view__body--resizing {
          outline: none !important;
          box-shadow: none !important;
          background: transparent !important;
        }

        &__placeholder {
          position: absolute;
          top: 0;
          left: 0;
          z-index: -1;
          width: 100%;
          height: 100%;
          display: none; // Hide placeholder in render mode
        }

        &__image {
          margin: 0;
          cursor: default !important;
          max-width: 100%;
          height: auto;
          display: block;

          // Ensure proper image rendering
          image-rendering: auto;
          -webkit-user-drag: none;
          user-drag: none;
        }
      }

      img {
        display: inline;
        vertical-align: baseline;
        max-width: 100%;
        height: auto;
        cursor: default !important;

        // Enhanced image quality
        image-rendering: auto;
        -webkit-user-drag: none;
        user-drag: none;
      }

      // Enhanced inline float image handling
      &[style*="float: left"] {
        float: left !important;
        margin: 1em 1em 1em 0 !important;
        clear: none !important;
      }

      &[style*="float: right"] {
        float: right !important;
        margin: 1em 0 1em 1em !important;
        clear: none !important;
      }

      // Handle different alignment styles
      &[style*="text-align: center"] {
        text-align: center;
        display: block;
        margin-left: auto;
        margin-right: auto;
      }

      &[style*="text-align: left"] {
        text-align: left;
        display: block;
      }

      &[style*="text-align: right"] {
        text-align: right;
        display: block;
      }
    }

    // Completely hide all interactive image elements
    .image-resizer,
    .image-upload-progress,
    .image-toolbar,
    .image-actions {
      display: none !important;
      visibility: hidden !important;
    }

    // Enhanced image container alignment styles
    div.image {
      &[style*="text-align: left"] {
        text-align: left !important;
        margin-left: 0;
        margin-right: auto;
      }
      &[style*="text-align: center"] {
        text-align: center !important;
        margin-left: auto;
        margin-right: auto;
      }
      &[style*="text-align: right"] {
        text-align: right !important;
        margin-left: auto;
        margin-right: 0;
      }
    }

    // Enhanced inline image float styles
    span.image {
      &[style*="float: left"] {
        float: left !important;
        margin: 1em 1em 1em 0 !important;
        clear: none;

        img {
          float: left;
          margin: 0;
        }
      }
      &[style*="float: right"] {
        float: right !important;
        margin: 1em 0 1em 1em !important;
        clear: none;

        img {
          float: right;
          margin: 0;
        }
      }
    }

    // Enhanced image sizing with proper fallbacks
    img[width] {
      width: attr(width px) !important;
      max-width: 100%;
    }

    img[style*="width"] {
      max-width: 100% !important;
      height: auto !important;
    }

    // Ensure all images are properly sized
    img {
      max-width: 100%;
      height: auto;
      display: inline-block;
      vertical-align: middle;
    }

    // Additional table styles to ensure proper rendering
    table {
      @apply richtext-border-collapse richtext-table-fixed richtext-w-full;

      td, th {
        @apply richtext-box-border richtext-relative richtext-text-left richtext-align-top;

        p {
          @apply richtext-m-0;

          & + p {
            @apply richtext-mt-3;
          }
        }
      }

      th {
        @apply richtext-font-bold;
      }
    }
  }
}

// Ensure editor styles are also applied to render engine when using both classes
.reactjs-tiptap-render-engine.reactjs-tiptap-editor {
  .ProseMirror.ProseMirror.ProseMirror {
    // Import critical editor styles for proper rendering
    .tableWrapper {
      margin: 1em 0;
      @apply richtext-overflow-x-auto;

      table {
        overflow: hidden;
        display: table;
        width: 100%;
      }
    }

    // Ensure image styles from editor are applied
    .image-view {
      $root: &;

      display: inline-block;
      float: none;
      max-width: 100%;
      line-height: 0;
      vertical-align: baseline;
      user-select: none;

      &__body {
        position: relative;
        display: inline-block;
        max-width: 100%;
        clear: both;
        outline: transparent solid 2px;

        &__image {
          margin: 0;
          cursor: default !important;
        }
      }

      img {
        display: inline;
        vertical-align: baseline;
      }
    }

    // Override editor-specific interactive elements
    .image-resizer,
    .image-view__body__button-wrap {
      display: none !important;
    }

    // Disable hover effects
    .image-view__body:hover {
      outline-color: transparent !important;
    }

    [data-type='horizontalRule']:hover {
      background: transparent !important;
    }
  }
}
